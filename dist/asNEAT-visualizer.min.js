/* asNEAT-visualizer 0.0.3 2014-03-27 */
define("asNEAT/asNEAT-visualizer",["asNEAT/visualization","exports"],function(a,b){"use strict";var c=a["default"],d={};d.createVisualization=function(a){return new c(a)},b["default"]=d}),define("asNEAT/graph",["exports"],function(a){"use strict";var b=require("asNEAT/nodes/outNode")["default"],c=require("asNEAT/utils")["default"].log,d=function(){};d.longestPath=function(a,f){_.forEach(a,function(a){a.cleanParameters()});var g=_.find(a,function(a){return a.asNEATNode instanceof b});c("found outNode: "+g.asNEATNode.toString());var h=[];h=_.union(h,d.getConnectionsGoingTo(g,f));var i=[],j=new e(g);for(g.longestPath=j,g.numHops=j.getLength(),i.push(j);h.length;){var k=h.pop(),l=k.inVNode,m=k.outVNode;if(l.longestPath)c("todo collision");else{var n=m.longestPath;n.isLastNode(m)||(n=n.duplicateFromNode(g)),n.pushNode(l),l.numHops=n.getLength(),l.longestPath=n}h=_.union(h,d.getConnectionsGoingTo(l,f))}var o={};_.forEach(a,function(a){var b=a.getLocalX(),c=o[b];c||(c={value:0},o[b]=c),a.hashElement=c,a.yIndex=c.value++})},d.getConnectionsGoingTo=function(a,b){return _.filter(b,function(b){return b.asNEATConnection.enabled&&b.outVNode===a})};var e=function(a){this.nodes=[],a&&this.pushNode(a)};e.prototype.pushNode=function(a){this.nodes.push(a)},e.prototype.inPath=function(a){return!!_.find(this.nodes,{asNEATNode:a.asNEATNode})},e.prototype.getLength=function(){return this.nodes.length-1},e.prototype.isLastNode=function(a){return this.nodes[this.nodes.length-1]===a},e.prototype.duplicateFromNode=function(a){var b=_.findIndex(this.nodes,function(b){return b.asNEATNode===a.asNEATNode}),c=new e;return c.nodes=this.nodes.slice(0,b+1),c},a["default"]=d}),define("asNEAT/vConnection",["exports"],function(a){"use strict";var b=function(a){_.defaults(this,a,this.defaultParameters)};b.prototype.defaultParameters={inVNode:null,outVNode:null,asNEATConnection:null},a["default"]=b}),define("asNEAT/vNode",["exports"],function(a){"use strict";var b=function(a){_.defaults(this,a,this.defaultParameters)};b.prototype.defaultParameters={numHops:0,longestPath:null,yIndex:0,hashElement:null,asNEATNode:null},b.prototype.cleanParameters=function(){this.numHops=0,this.longestPath=null,this.yIndex=0,this.hashElement=null},b.prototype.getLongestPathLength=function(){return this.longestPath?this.longestPath.getLength():1},b.prototype.getNumberNodesInHash=function(){return this.hashElement?this.hashElement.value:1},b.prototype.getLocalX=function(){return 1-this.numHops/this.getLongestPathLength()},b.prototype.getLocalY=function(){return(this.yIndex+1)/(this.getNumberNodesInHash()+1)},b.prototype.getLabel=function(){return"("+this.numHops+"/"+this.getLongestPathLength()+", "+this.yIndex+"/"+this.getNumberNodesInHash()+")"},b.createVNodeFrom=function(a){return new b({asNEATNode:a})},a["default"]=b}),define("asNEAT/visualization",["exports"],function(a){"use strict";var b=require("asNEAT/nodes/oscillatorNode")["default"],c=require("asNEAT/nodes/outNode")["default"],d=require("asNEAT/vNode")["default"],e=require("asNEAT/vConnection")["default"],f=require("asNEAT/graph")["default"],g=function(a){_.defaults(this,a,this.defaultParameters);var b=d3.select(this.selector).append("svg").attr("width",this.width).attr("height",this.height);b.append("g").attr("class","connections"),b.append("g").attr("class","nodes"),b.append("g").attr("class","labels"),this.svg=b,this.vNodes=[],this.vConnections=[],this.refresh();var c=this,d=window.onresize;window.onresize=function(){c.refresh(),d&&d()}};g.prototype.defaultParameters={network:null,width:"100%",height:600,padding:60,selector:".network",animateSpeed:750},g.prototype.updateVisualizationNetwork=function(){var a=this.vNodes,b=this.vConnections;_.forEach(this.network.nodes,function(b){var c=_.find(a,{asNEATNode:b});c||a.push(d.createVNodeFrom(b))}),_.forEach(this.network.connections,function(c){var d=_.find(b,{asNEATConnection:c});if(!d){var f=_.find(a,{asNEATNode:c.inNode}),g=_.find(a,{asNEATNode:c.outNode});b.push(new e({inVNode:f,outVNode:g,asNEATConnection:c}))}}),f.longestPath(a,b)},g.prototype.refresh=function(){function a(a){return a.getLocalX()*(q-2*s)+s}function d(a){return a.getLocalY()*(r-2*s)+s}function e(a){var b=g(a),c=h(a);return"M"+b+","+c+" C"+b+","+c+" "+b+","+c+" "+b+","+c}function f(a){var b=g(a),c=h(a),d=i(a),e=j(a);return"M"+b+","+c+" C"+(b+u)+","+c+" "+(d-u)+","+e+" "+d+","+e}function g(b){return a(b.inVNode)}function h(a){return d(a.inVNode)}function i(b){return a(b.outVNode)}function j(a){return d(a.outVNode)}function k(a){return a.asNEATNode instanceof b?"green":a.asNEATNode instanceof c?"black":"red"}function l(a){return a.asNEATConnection.enabled?"black":"gray"}function m(a){return a.asNEATConnection.id}var n=this.vNodes,o=this.vConnections,p=this.svg[0][0].getClientRects()[0],q=p.width,r=p.height,s=this.padding,t=this.animateSpeed;this.updateVisualizationNetwork();var u=200,v=this.svg.select(".nodes").selectAll(".node").data(n);v.transition().duration(t).attr("cx",a).attr("cy",d).attr("r",10),v.enter().append("circle").attr("class","node").attr("cx",a).attr("cy",d).attr("r",0).attr("stroke","black").attr("stroke-width",2).attr("fill",k).transition().duration(t).attr("r",10);var w=this.svg.select(".connections").selectAll(".connection").data(o,m);w.transition().duration(t).attr("d",f).style("stroke",l),w.enter().append("path").attr("class","connection").attr("d",e).attr("fill","none").style("stroke",l).style("stroke-width",2).transition().duration(t).attr("d",f);var x=this.svg.select(".labels").selectAll(".label").data(n);x.transition().duration(t).attr("x",a).attr("y",d).text(function(a){return a.getLabel()}),x.enter().append("text").attr("class","label").attr("x",a).attr("y",d).style("fill","red").text(function(a){return a.getLabel()})},a["default"]=g});